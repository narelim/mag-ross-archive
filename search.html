---
layout: default
title: Archive
---

<div class="hero">
    <h1 style="font-family: 'Gruppo', sans-serif;">UNIVERSE</h1>
</div>

<div class="archive-container">
    
    <aside class="sidebar">
    <div class="sidebar-section">
        <input type="text" id="search-input" placeholder="Search..." 
        style="width: 100%; padding: 10px; border: 1px solid #111; font-family: 'Noto Sans KR'; outline: none;">
    </div>

    <div class="sidebar-section">
        <span class="sidebar-title">CATEGORY</span>
        <div class="filter-group">
            <span class="filter-link active" onclick="filterCategory('all', this)">ALL</span>
            
            {% assign sorted_categories = site.categories | sort %}
            {% for category in sorted_categories %}
                {% assign cat_name = category[0] %}
                {% assign cat_posts = category[1] %}
                
                {% assign show_cat = false %}
                {% for post in cat_posts %}
                    {% assign p_type = post.type | downcase %}
                    {% unless p_type == 'secret' %}
                        {% assign show_cat = true %}
                    {% endunless %}
                {% endfor %}

                {% if show_cat %}
                <span class="filter-link" onclick="filterCategory('{{ cat_name }}', this)">{{ cat_name }}</span>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="sidebar-section">
        <span class="sidebar-title">TAGS</span>
        <div class="filter-group">
            
            {% assign sorted_tags = site.tags | sort %}
            {% for tag in sorted_tags %}
                {% assign tag_name = tag[0] %}
                {% assign tag_posts = tag[1] %}
                
                {% assign show_tag = false %}
                {% for post in tag_posts %}
                    {% assign p_type = post.type | downcase %}
                    {% unless p_type == 'secret' %}
                        {% assign show_tag = true %}
                    {% endunless %}
                {% endfor %}

                {% if show_tag %}
                <span class="filter-link" onclick="filterSearch('{{ tag_name }}', this)"># {{ tag_name }}</span>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</aside>



    <main class="archive-main">
        
        <div class="archive-header">
            <div>
                <span style="color:#999; margin-right:10px;">Filter:</span>
                <span id="current-filter" class="selected-tag">ALL</span>
            </div>
            
            <div class="view-options">
                <button onclick="changeView('grid')" id="btn-grid">▦</button>
                <button onclick="changeView('list')" id="btn-list" class="active">≡</button>
            </div>
        </div>

        <ul id="post-list" class="post-list view-list">
            {% for post in site.posts %}
            {% assign p_type = post.type | downcase %}
            {% unless p_type == 'secret' %}
            
            <li class="post-item search-item" 
                data-title="{{ post.title }}" 
                data-tags="{{ post.tags | join: ',' }}"
                data-category="{{ post.category }}">
                
                <a href="{{ post.url | relative_url }}" class="thumb-link">
                    {% if post.image %}
                        <img src="{{ post.image | prepend: '/assets/thumbnails/' | relative_url }}" alt="thumb">
                    {% else %}
                        <img src="{{ 'main_image.jpeg' | relative_url }}" alt="thumb">
                    {% endif %}
                </a>

                <div style="flex: 1;">
                    <div class="post-meta">
                        {{ post.category }} 
                        <span style="color: #999; font-size: 0.8em;">
                            {% for tag in post.tags %}#{{ tag }} {% endfor %}
                        </span>
                    </div>
                    <a href="{{ post.url | relative_url }}" style="font-size: 1.2rem; font-weight: bold;">{{ post.title }}</a>
                </div>
            </li>
            
            {% endunless %}
            {% endfor %}
        </ul>
    </main>
</div>

<script>
    // 1. 보기 방식 변경 (그리드 <-> 리스트)
    function changeView(type) {
        const list = document.getElementById('post-list');
        const btnGrid = document.getElementById('btn-grid');
        const btnList = document.getElementById('btn-list');

        if (type === 'grid') {
            list.classList.remove('view-list');
            list.classList.add('view-grid');
            btnGrid.classList.add('active');
            btnList.classList.remove('active');
        } else {
            list.classList.remove('view-grid');
            list.classList.add('view-list');
            btnList.classList.add('active');
            btnGrid.classList.remove('active');
        }
    }

    // 2. 카테고리 필터링
    function filterCategory(category, element) {
        updateActiveLink(element); // 클릭한 글자 붉게 만들기
        document.getElementById('current-filter').innerText = category.toUpperCase();
        
        const items = document.getElementsByClassName('search-item');
        for (let item of items) {
            let itemCat = item.getAttribute('data-category');
            if (category === 'all' || itemCat === category) {
                item.style.display = 'flex'; // 혹은 block (뷰 모드에 따라 CSS가 알아서 처리함)
            } else {
                item.style.display = 'none';
            }
        }
    }

    // 3. 태그 검색 필터링 (왼쪽 태그 클릭 시)
    function filterSearch(keyword, element) {
        updateActiveLink(element);
        document.getElementById('current-filter').innerText = "# " + keyword;
        
        const items = document.getElementsByClassName('search-item');
        for (let item of items) {
            let tags = item.getAttribute('data-tags').toLowerCase();
            if (tags.includes(keyword.toLowerCase())) {
                item.style.display = 'flex';
            } else {
                item.style.display = 'none';
            }
        }
    }

    // 4. 검색창 입력
    document.getElementById('search-input').addEventListener('keyup', function() {
        let val = this.value.toLowerCase();
        document.getElementById('current-filter').innerText = "SEARCH: " + val;
        
        const items = document.getElementsByClassName('search-item');
        for (let item of items) {
            let title = item.getAttribute('data-title').toLowerCase();
            let tags = item.getAttribute('data-tags').toLowerCase();
            if (title.includes(val) || tags.includes(val)) {
                item.style.display = 'flex';
            } else {
                item.style.display = 'none';
            }
        }
    });

    // (보조) 클릭한 메뉴만 붉게 표시하는 함수
    function updateActiveLink(target) {
        const links = document.querySelectorAll('.filter-link');
        links.forEach(link => link.classList.remove('active'));
        target.classList.add('active');
    }
</script>

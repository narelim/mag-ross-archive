<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;400;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="manifest" href="{{ '/manifest.json' | relative_url }}">
<meta name="theme-color" content="#E87A90">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    
    <style>
        /* --- ê¸°ë³¸ ì„¤ì • (ì‚¬ì¿ ë¼ í…Œë§ˆ) --- */
        body {
            background-color: #FFF9FB; /* ë°°ê²½: ì•„ì£¼ ì—°í•œ í•‘í¬ í™”ì´íŠ¸ */
            margin: 0;
            padding-top: 135px;
            font-family: 'Noto Sans KR', sans-serif;
            color: #333; /* ê¸°ë³¸ ê¸€ìëŠ” ê°€ë…ì„± ì¢‹ê²Œ ì§„í•œ íšŒìƒ‰ */
        }

        /* 1. ğŸŒ¸ ìµœìƒë‹¨ í—¤ë” (ì›œ í•‘í¬) */
        .app-header {
            background-color: #E87A90; /* ì°¨ë¶„í•œ ë¡œì¦ˆ í•‘í¬ */
            color: white;
            display: flex;
            align-items: center;
            padding: 15px 20px;
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(232, 122, 144, 0.2); /* ê·¸ë¦¼ìë„ í•‘í¬í†¤ */
            box-sizing: border-box;
        }
        .back-btn {
            background: none; border: none; color: white;
            font-size: 1.5rem; cursor: pointer; padding: 0; margin-right: 15px;
            display: flex; align-items: center;
        }
        .app-title { font-weight: bold; flex: 1; font-size: 1.2rem; }
        .app-icons { font-size: 1.5rem; display: flex; gap: 15px; }
        .app-icons i { cursor: pointer; }


        /* 2. â„¹ï¸ ì‘í’ˆ ì •ë³´ í—¤ë” */
        .info-header {
            background: white;
            padding: 15px;
            display: flex;
            gap: 15px;
            position: fixed;
            top: 55px; left: 0; right: 0;
            z-index: 900;
            border-bottom: 1px solid #FFF0F5; /* êµ¬ë¶„ì„  ì•„ì£¼ ì—°í•œ í•‘í¬ */
            height: 80px; box-sizing: border-box;
        }
        .info-thumb {
            width: 50px; height: 50px;
            border-radius: 4px; overflow: hidden;
            border: 1px solid #FFE4E1; flex-shrink: 0;
        }
        .info-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .info-text { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .info-title { font-size: 0.95rem; font-weight: bold; margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; color: #444;}
        .info-tags { font-size: 0.75rem; color: #999; }
        .info-tags span { background: #FFF0F5; padding: 2px 5px; border-radius: 3px; margin-right: 4px; color: #E87A90; }
        
        /* ì•±ì—ì„œ ì—´ê¸° ë²„íŠ¼ */
        .open-app-btn {
            background: #E87A90; color: white; border: none;
            padding: 5px 10px; border-radius: 4px; font-weight: bold; font-size: 0.8rem;
            align-self: center; cursor: default;
        }


        /* 3. ğŸ“‚ í´ë” íƒ­ */
        .folder-tab-bar {
            max-width: 800px; margin: 20px auto 0 auto;
            padding: 0 20px;
            display: flex;
        }
        .folder-tab {
            background: #FFF0F5; /* íƒ­ ë°°ê²½: ì—°í•œ ë”¸ê¸°ìš°ìœ ìƒ‰ */
            color: #E87A90;       /* ê¸€ì: ë¡œì¦ˆ í•‘í¬ */
            padding: 8px 20px;
            border-radius: 10px 10px 0 0;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex; align-items: center; gap: 8px;
            position: relative;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.02);
        }
        .folder-tab::after {
            content: ''; position: absolute; bottom: -2px; left: 0; right: 0;
            height: 4px; background: white;
        }


        /* 4. ğŸ“„ í…ìŠ¤íŠ¸ ë·°ì–´ (ì¢…ì´) */
        .viewer-paper {
            max-width: 800px;
            margin: 0 auto 50px auto;
            background: #fff;
            padding: 40px 30px;
            min-height: 80vh;
            box-shadow: 0 2px 10px rgba(232, 122, 144, 0.05); /* ê·¸ë¦¼ìì— ì•„ì£¼ ì‚´ì§ í•‘í¬ ì„ê¸° */
            border-radius: 0 4px 4px 4px; 
            font-family: 'Noto Serif KR', serif;
            line-height: 1.8;
            font-size: 1.05rem;
            color: #333;
        }

        /* --- ğŸ“ ì²¨ë¶€íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ --- */
        .attach-box { 
            margin-top: 50px; 
            padding-top: 20px; 
            border-top: 2px dashed #FFE4E1; /* ì ì„ ë„ í•‘í¬ */
        }
        .attach-title { 
            font-size: 0.95rem; font-weight: bold; color: #888; 
            margin-bottom: 15px; font-family: sans-serif; 
        }

        /* ë²„íŠ¼ ë””ìì¸ */
        .file-btn {
            display: flex; align-items: center; gap: 15px;
            background: #fff; border: 1px solid #eee;
            padding: 10px; margin-bottom: 10px; border-radius: 8px;
            cursor: pointer; text-align: left; font-family: sans-serif; 
            color: #444; transition: all 0.2s; width: 100%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .file-btn:hover { 
            background: #FFF0F5; /* í˜¸ë²„ ì‹œ ì—°í•œ í•‘í¬ ë°°ê²½ */
            border-color: #E87A90; /* í…Œë‘ë¦¬ ë¡œì¦ˆ í•‘í¬ */
            transform: translateY(-2px);
        }

        /* ì¸ë„¤ì¼ */
        .file-thumb-img {
            width: 60px; height: 60px; border-radius: 6px;
            object-fit: cover; border: 1px solid #FFE4E1; background-color: #FFF0F5;
        }

        .file-info { display: flex; flex-direction: column; justify-content: center; }
        .file-name { font-size: 0.95rem; font-weight: bold; color: #444; margin-bottom: 3px; }
        .file-sub { font-size: 0.75rem; color: #999; }


        /* ì´ë¯¸ì§€ ëª¨ë‹¬ */
        #img-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; cursor: zoom-out; }
        #modal-img { max-width: 95%; max-height: 95%; border-radius: 4px; }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .viewer-paper { padding: 30px 20px; }
            .info-header { padding: 10px; }
        }

        /* --- ì•„ì½”ë””ì–¸(ì ‘ì´ì‹) ìŠ¤íƒ€ì¼ --- */
        details {
            background: #fff;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
            transition: all 0.3s;
        }

        /* ì œëª© ë¶€ë¶„ */
        summary {
            background: #fafafa;
            padding: 15px 20px;
            font-weight: bold;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 0.95rem;
            color: #555; /* í‰ì†Œì—” ì˜ ë³´ì´ê²Œ íšŒìƒ‰ */
            cursor: pointer;
            list-style: none;
            display: flex; justify-content: space-between; align-items: center;
        }
        summary::-webkit-details-marker { display: none; }

        /* ë§ˆìš°ìŠ¤ ì˜¬ë ¸ì„ ë•Œ */
        summary:hover { background: #FFF0F5; color: #E87A90; }

        /* í™”ì‚´í‘œ */
        summary::after {
            content: '\f078'; font-family: "Font Awesome 5 Free"; font-weight: 900;
            transition: transform 0.3s; font-size: 0.8rem; color: #ccc;
        }

        /* í¼ì³ì¡Œì„ ë•Œ */
        details[open] {
            border-color: #E87A90; /* í…Œë‘ë¦¬ í•‘í¬ */
            box-shadow: 0 4px 10px rgba(232, 122, 144, 0.1);
        }
        details[open] summary {
            border-bottom: 1px solid #FFF0F5;
            color: #E87A90; /* ì œëª© í•‘í¬ìƒ‰ìœ¼ë¡œ ë³€ì‹  */
            background: #FFF9FB;
        }
        details[open] summary::after {
            transform: rotate(180deg);
            color: #E87A90;
        }

        /* ë‚´ìš© */
        details .details-content {
            padding: 20px;
            line-height: 1.8;
            color: #333;
            background: #fff;
            white-space: pre-wrap; 
            word-break: break-all;
        }

        /* --- ğŸ’¬ ì‹¬í”Œ ì±„íŒ… ìŠ¤íƒ€ì¼ (ë§í’ì„  Only) --- */

.chat-room {
    background-color: #FFF0F5; /* ì—°í•œ í•‘í¬ ë°°ê²½ */
    padding: 20px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    gap: 10px; /* ë§í’ì„  ê°„ê²© */
    font-family: 'Noto Sans KR', sans-serif;
}

.msg-row {
    display: flex;
    max-width: 100%;
}

/* â˜ï¸ ë§í’ì„  ê³µí†µ ë””ìì¸ */
.msg-bubble {
    padding: 10px 14px;
    border-radius: 15px;
    font-size: 0.95rem;
    line-height: 1.5;
    position: relative;
    max-width: 80%;
    word-break: break-all; /* ê¸´ ë‹¨ì–´ ì¤„ë°”ê¿ˆ */
}

/* â¬…ï¸ ìƒëŒ€ë°© (ì™¼ìª½, í°ìƒ‰) */
.msg-row.left { justify-content: flex-start; }
.msg-row.left .msg-bubble {
    background: #ffffff;
    color: #333;
    border-bottom-left-radius: 2px; /* ê¼¬ë¦¬ ëŠë‚Œ */
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

/* â¡ï¸ ë‚˜ (ì˜¤ë¥¸ìª½, í•‘í¬ìƒ‰) */
.msg-row.right { justify-content: flex-end; }
.msg-row.right .msg-bubble {
    background: #E87A90;
    color: white;
    border-bottom-right-radius: 2px; /* ê¼¬ë¦¬ ëŠë‚Œ */
}

        /* ğŸ“¸ ë§í’ì„  ì•ˆì˜ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ (ìˆ˜ì •ë³¸) */

/* ì™¼ìª½/ì˜¤ë¥¸ìª½ êµ¬ë¶„ ì—†ì´ í•œ ë²ˆì— ì ìš© (ì½”ë“œ ê°„ì†Œí™”) */
.msg-bubble img {
    max-width: 100% !important;  /* ğŸš¨ ë§í’ì„ ë³´ë‹¤ ì ˆëŒ€ ì»¤ì§€ì§€ ì•Šê²Œ! */
    height: auto !important;     /* ë¹„ìœ¨ ìœ ì§€ */
    border-radius: 10px;         /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
    display: block;              
    margin: 5px 0 !important;               /* ğŸš¨ ì˜¤íƒ€ ìˆ˜ì •ë¨! (margin-top -> margin) */
}

        /* --- ğŸ¦ íŠ¸ìœ„í„° íƒ€ë˜(Thread) ìŠ¤íƒ€ì¼ (ì‹¬í”Œ ë²„ì „) --- */

/* ì „ì²´ íƒ€ë˜ ì»¨í…Œì´ë„ˆ (ì™¼ìª½ ì„ ) */
.twitter-thread {
    margin-left: 15px; /* ë²½ì—ì„œ ì‚´ì§ ë„ìš°ê¸° */
    border-left: 2px solid #E87A90; /* ğŸŒ¸ í•‘í¬ìƒ‰ ì—°ê²°ì„  */
    padding-left: 25px; /* ì„ ê³¼ ë‚´ìš© ì‚¬ì´ ê°„ê²© */
    padding-top: 10px;
    padding-bottom: 10px;
}

/* ê°œë³„ íŠ¸ìœ— ë°•ìŠ¤ */
.tweet-item {
    position: relative;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px; /* íŠ¸ìœ— ì‚¬ì´ ê°„ê²© */
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    font-size: 0.95rem;
    line-height: 1.6;
    color: #444;
}

/* íƒ€ì„ë¼ì¸ ì  (â—) ê¾¸ë¯¸ê¸° */
.tweet-item::before {
    content: '';
    position: absolute;
    left: -32px; /* ì„  ìœ„ë¡œ ì  ì˜®ê¸°ê¸° */
    top: 15px;   /* ì  ìœ„ì¹˜ ì¡°ì • */
    width: 12px;
    height: 12px;
    background: #fff;
    border: 2px solid #E87A90; /* ğŸŒ¸ í•‘í¬ í…Œë‘ë¦¬ ì  */
    border-radius: 50%;
    z-index: 1;
}

/* (ì˜µì…˜) ì•¤ì˜¤ë‹˜ ì°ì€ ì‚´ì§ ë‹¤ë¥´ê²Œ í‘œì‹œí•˜ê³  ì‹¶ë‹¤ë©´? */
/* ì•¤ì˜¤ íŠ¸ìœ—ì—” ë°°ê²½ìƒ‰ì„ ì•„ì£¼ ì—°í•˜ê²Œ ì¤Œ */
.tweet-item.partner {
    background: #FFF9FB; 
    border-color: #FFE4E1;
}
/* ì•¤ì˜¤ íŠ¸ìœ—ì€ ì ì„ ê½‰ ì±„ìš´ í•‘í¬ë¡œ */
.tweet-item.partner::before {
    background: #E87A90; 
}

    </style>
</head>
<body>

    <header class="app-header">
        <button class="back-btn" onclick="history.back()">
            <i class="fas fa-arrow-left"></i>
        </button>
        <div class="app-title">Backstage</div>
        <div class="app-icons">
            <i class="fas fa-heart"></i>
            <i id="install-btn" class="fas fa-download"></i>
        </div>
    </header>

    <div class="info-header">
<div class="info-thumb">
    {% if page.image %}
        {% if page.image contains '/' %}
            <img src="{{ page.image | relative_url }}">
        {% else %}
            <img src="{{ '/assets/img/' | append: page.image | relative_url }}">
        {% endif %}
    {% else %}
        <img src="https://via.placeholder.com/50x50?text=No+Img">
    {% endif %}
</div>

        <div class="info-text">
            <div class="info-title">{{ page.title }}</div>
            <div class="info-tags">
                {% for tag in page.tags limit:5 %}
                    <span>{{ tag }}</span>
                {% endfor %}
            </div>
        </div>
    </div>


    <div class="folder-tab-bar">
        <div class="folder-tab">
            <i class="fas fa-folder-open"></i>
            {{ page.tags | first | default: "Library" }}
        </div>
    </div>


    <div class="viewer-paper">
        {{ content }}

        {% if page.attachments %}
        <div class="attach-box">
            <div class="attach-title">
                <i class="fas fa-paperclip"></i> ì²¨ë¶€ íŒŒì¼ ({{ page.attachments | size }}ê°œ)
            </div>
            
            {% for img in page.attachments %}
            
            {% assign filename = img | split: '/' | last %}

            <button class="file-btn" onclick="openModal('{{ img | relative_url }}')">
                
                <img src="{{ img | relative_url }}" class="file-thumb-img" alt="thumb">
                
                <div class="file-info">
                    <span class="file-name">{{ filename }}</span>
                    <span class="file-sub">ì´ë¯¸ì§€ í¬ê²Œ ë³´ê¸° (Click to view)</span>
                </div>
            </button>
            {% endfor %}
        </div>
        {% endif %}

    </div>


    <div id="img-modal" onclick="this.style.display='none'">
        <img id="modal-img" src="">
    </div>

    <script>
        // (ê¸°ì¡´) ì´ë¯¸ì§€ ëª¨ë‹¬ í•¨ìˆ˜
        function openModal(src) {
            document.getElementById('modal-img').src = src;
            document.getElementById('img-modal').style.display = 'flex';
        }


        // --- ğŸ“² (ì¶”ê°€ë¨) ì•± ì„¤ì¹˜ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ ---
        
        let deferredPrompt; // ì•ˆë“œë¡œì´ë“œ ì„¤ì¹˜ íŒì—… ì €ì¥ìš©
        const installBtn = document.getElementById('install-btn');

        // 1. ì•ˆë“œë¡œì´ë“œ: ì„¤ì¹˜ ê°€ëŠ¥í•œ ìƒíƒœ ê°ì§€
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // ì„¤ì¹˜ ê°€ëŠ¥í•  ë•Œë§Œ ë²„íŠ¼ì´ ë°˜ì§ì´ê±°ë‚˜ ìƒ‰ì´ ì§„í•´ì§€ê²Œ í•  ìˆ˜ë„ ìˆìŒ (ì„ íƒì‚¬í•­)
            // ì—¬ê¸°ì„œëŠ” ì¼ë‹¨ ê¸°ëŠ¥ë§Œ ì—°ê²°í•©ë‹ˆë‹¤.
        });

        // 2. ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘
        installBtn.addEventListener('click', () => {
            
            // (A) ì•ˆë“œë¡œì´ë“œ: ì§„ì§œ ì„¤ì¹˜ ì°½ ë„ìš°ê¸°
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ì„¤ì¹˜ ì™„ë£Œ!');
                        installBtn.style.display = 'none'; // ì„¤ì¹˜í–ˆìœ¼ë©´ ìˆ¨ê¹€
                    }
                    deferredPrompt = null;
                });
            } 
            // (B) ì•„ì´í°/PC: ì¹œì ˆí•œ ì„¤ëª… ë„ìš°ê¸°
            else {
                const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                if (isIOS) {
                    alert("ğŸ’Œ ì•„ì´í° ì„¤ì¹˜ íŒ\n\ní•˜ë‹¨ [ê³µìœ ] ë²„íŠ¼ -> [í™ˆ í™”ë©´ì— ì¶”ê°€ â•]\n\nì´ë ‡ê²Œ í•˜ë©´ ì§„ì§œ ì•±ì²˜ëŸ¼ ì „ì²´í™”ë©´ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆì–´ìš”! ğŸŒ¸");
                } else {
                    alert("ë¸Œë¼ìš°ì € ë©”ë‰´ì—ì„œ [ì•± ì„¤ì¹˜] ë˜ëŠ” [í™ˆ í™”ë©´ì— ì¶”ê°€]ë¥¼ ì°¾ì•„ë³´ì„¸ìš”!");
                }
            }
        });
    </script>


</body>
</html>

---
layout: page
title: "Secret Archive"
permalink: /secret/
---

<link rel="stylesheet" href="{{ '/assets/css/dl-style.css' | relative_url }}">

<style>
    .container, .page-content { max-width: 100% !important; padding: 0 20px !important; }
    .post-header { display: none; }

    /* í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .filter-btn {
        display: inline-block;
        font-size: 0.85rem;
        background: #f5f5f5;
        color: #555;
        padding: 6px 12px;
        border-radius: 20px;
        margin: 4px;
        border: 1px solid #ddd;
        cursor: pointer;
        transition: all 0.2s;
        user-select: none; /* ë“œë˜ê·¸ ë°©ì§€ */
    }
    .filter-btn:hover {
        background: #ffeef5;
        color: #E6007E;
        border-color: #E6007E;
    }
    /* ğŸš¨ ì„ íƒë˜ì—ˆì„ ë•Œ (í™œì„±í™”) */
    .filter-btn.active {
        background: #E6007E;  /* í•‘í¬ìƒ‰ ë°°ê²½ */
        color: #fff;           /* í°ìƒ‰ ê¸€ì”¨ */
        border-color: #E6007E;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(230, 0, 126, 0.3);
    }
</style>


<div id="lock-gate" style="text-align: center; padding: 100px 20px;">
    <h2 style="font-family: 'Noto Serif KR'; color: #780C1B; font-size: 2rem;">Restricted Area</h2>
    <p style="color: #666; margin-bottom: 30px;">
        ê´€ê³„ì ì™¸ ì¶œì… ê¸ˆì§€ êµ¬ì—­ì…ë‹ˆë‹¤.<br>
        ì„±ì¸ ì¸ì¦(ë¹„ë°€ë²ˆí˜¸)ì´ í•„ìš”í•©ë‹ˆë‹¤.
    </p>
    <input type="password" id="user-pass" placeholder="Password" 
           style="padding: 12px; border: 1px solid #ccc; width: 200px; text-align: center;">
    <button onclick="unlock()" 
            style="padding: 12px 25px; background: #780C1B; color: white; border: none; cursor: pointer; font-weight: bold;">
        Enter
    </button>
    <p id="error-msg" style="color: #780C1B; font-size: 0.8rem; margin-top: 15px; display: none;">
        â›” ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.
    </p>
</div>


<div id="secret-content" style="display: none; margin-top: 40px;">
    
    <div style="text-align:center; margin-bottom: 50px; border-bottom: 1px solid #eee; padding-bottom: 30px;">
        <h1 style="font-family: 'Noto Serif KR'; font-size: 2.5rem; color: #111; margin-bottom: 10px;">SECRET ARCHIVE</h1>
        <p style="color: #888; font-style: italic;">Douglas x Adeline : Unspoken Stories (R-18)</p>
    </div>

    <div class="dl-container">
        
        <aside class="dl-sidebar">
            
            <div class="dl-menu-box">
                <div class="dl-menu-title">ğŸ·ï¸ íƒœê·¸ í•„í„° (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)</div>
                <div id="tag-filter-container" style="padding: 15px;">
                    </div>
                <div style="text-align: center; padding-bottom: 15px;">
                    <button onclick="resetFilters()" style="font-size: 0.8rem; color: #888; background:none; border:none; cursor:pointer; text-decoration: underline;">
                        â†º í•„í„° ì´ˆê¸°í™”
                    </button>
                </div>
            </div>

            </aside>

        <main class="dl-main">
            <div class="dl-section-header">
                <h2 class="dl-section-title">ğŸ“¦ ì‘í’ˆ ëª©ë¡</h2>
                <span class="dl-section-more" id="item-count">Calculating...</span>
            </div>

            <div class="dl-grid" id="post-grid">
                
                {% for post in site.posts %}
                    {% if post.type == 'Secret' %}
                    
                    <a href="{{ post.url | relative_url }}" class="dl-card" 
                       data-tags="{{ post.tags | join: ',' }}">
                        
                        <div class="dl-thumb">
                            <span class="dl-badge">R-18</span>
                            {% if post.image %}
                                <img src="{{ post.image | relative_url }}" alt="{{ post.title }}">
                            {% else %}
                                <div style="width:100%; height:100%; background:#eee; display:flex; align-items:center; justify-content:center; color:#ccc;">No Image</div>
                            {% endif %}
                        </div>

                        <div class="dl-info">
                            <h3 class="dl-title">{{ post.title }}</h3>
                            <span class="dl-circle">Writer. {{ post.author | default: "ì¬ì€" }}</span>
                            <div class="dl-tags">
                                {% for tag in post.tags %}
                                    <span class="dl-tag">#{{ tag }}</span>
                                {% endfor %}
                            </div>
                            <div class="dl-footer">
                                <span class="dl-price">{{ post.date | date: "%Y.%m.%d" }}</span>
                                <span class="dl-btn">ì—´ëŒ</span>
                            </div>
                        </div>
                    </a>
                    
                    {% endif %}
                {% endfor %}

                <div id="no-result-msg" style="display:none; grid-column: 1 / -1; text-align: center; padding: 50px; color: #888;">
                    ì¡°ê±´ì— ë§ëŠ” ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤. ğŸ˜¢
                </div>

            </div>
        </main>
    </div>
</div>


<script>
    // === [0] í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ê²€ì‚¬ ===
    document.addEventListener("DOMContentLoaded", function() {
        // ë¸Œë¼ìš°ì €ì— 'ì¸ì¦ ë„ì¥(secret_unlocked)'ì´ ìˆëŠ”ì§€ í™•ì¸
        if (localStorage.getItem("secret_unlocked") === "true") {
            grantAccess(); // ë„ì¥ ìˆìœ¼ë©´ ë°”ë¡œ í†µê³¼!
        }
    });


    // === [1] ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•¨ìˆ˜ ===
    function unlock() {
        var password = "201107"; // ğŸ”‘ ë¹„ë°€ë²ˆí˜¸
        var input = document.getElementById("user-pass").value;
        
        if (input === password) {
            // ì •ë‹µì´ë©´ 'ì¸ì¦ ë„ì¥'ì„ ë¸Œë¼ìš°ì €ì— ì €ì¥ (ì˜êµ¬ ë³´ê´€)
            localStorage.setItem("secret_unlocked", "true");
            grantAccess();
        } else {
            document.getElementById("error-msg").style.display = "block";
            // í‹€ë ¸ì„ ë•Œ ì…ë ¥ì°½ í”ë“¤ê¸° (ì„ íƒì‚¬í•­)
            var passInput = document.getElementById("user-pass");
            passInput.style.borderColor = "red";
            setTimeout(() => { passInput.style.borderColor = "#ccc"; }, 500);
        }
    }
    
    // ì—”í„°í‚¤ ì§€ì›
    document.getElementById("user-pass").addEventListener("keypress", function(event) {
        if (event.key === "Enter") { event.preventDefault(); unlock(); }
    });


    // === [2] ë¬¸ ì—´ì–´ì£¼ëŠ” í•¨ìˆ˜ (ê³µí†µ) ===
    function grantAccess() {
        document.getElementById("lock-gate").style.display = "none";
        document.getElementById("secret-content").style.display = "block";
        
        // ğŸ”“ ì ê¸ˆ í’€ë¦¬ë©´ í•„í„° ì‹œìŠ¤í…œ ê°€ë™! (ì´ê±° ì¤‘ìš”)
        initTagSystem(); 
    }


    // === [3] íƒœê·¸ í•„í„°ë§ ì‹œìŠ¤í…œ (ìë™í™”) ===
    let selectedTags = new Set();

    function initTagSystem() {
        const cards = document.querySelectorAll('.dl-card');
        const tagContainer = document.getElementById('tag-filter-container');
        
        // ì´ë¯¸ ë²„íŠ¼ì´ ë§Œë“¤ì–´ì ¸ ìˆë‹¤ë©´ ì¤‘ë³µ ìƒì„± ë°©ì§€
        if (tagContainer.children.length > 0) return;

        let allTags = new Set(); 

        // 1. íƒœê·¸ ìˆ˜ì§‘
        cards.forEach(card => {
            if(card.dataset.tags) {
                const tags = card.dataset.tags.split(',');
                tags.forEach(tag => {
                    if(tag.trim() !== "") allTags.add(tag.trim());
                });
            }
        });

        // 2. ë²„íŠ¼ ìƒì„±
        const sortedTags = Array.from(allTags).sort();
        sortedTags.forEach(tag => {
            const btn = document.createElement('span');
            btn.className = 'filter-btn';
            btn.innerText = '#' + tag;
            btn.onclick = () => toggleTag(tag, btn);
            tagContainer.appendChild(btn);
        });

        updateCount();
    }


    // íƒœê·¸ í† ê¸€
    function toggleTag(tag, btnElement) {
        if (selectedTags.has(tag)) {
            selectedTags.delete(tag);
            btnElement.classList.remove('active');
        } else {
            selectedTags.add(tag);
            btnElement.classList.add('active');
        }
        applyFilter();
    }


    // í•„í„° ì ìš© (êµì§‘í•©)
    function applyFilter() {
        const cards = document.querySelectorAll('.dl-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const cardTags = card.dataset.tags ? card.dataset.tags.split(',') : [];
            const isMatch = Array.from(selectedTags).every(selected => cardTags.includes(selected));

            if (isMatch) {
                card.style.display = "flex";
                visibleCount++;
            } else {
                card.style.display = "none";
            }
        });

        const noResult = document.getElementById('no-result-msg');
        if (noResult) {
            noResult.style.display = (visibleCount === 0) ? "block" : "none";
        }
        updateCount();
    }


    // í•„í„° ì´ˆê¸°í™”
    function resetFilters() {
        selectedTags.clear();
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        applyFilter();
    }

    // ì•„ì´í…œ ê°œìˆ˜ ì—…ë°ì´íŠ¸
    function updateCount() {
        let realCount = 0;
        document.querySelectorAll('.dl-card').forEach(c => {
            if(c.style.display !== 'none') realCount++;
        });
        const countDisplay = document.getElementById('item-count');
        if(countDisplay) countDisplay.innerText = "Total " + realCount + " Items";
    }
</script>

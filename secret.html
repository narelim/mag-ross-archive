---
layout: page
title: "Secret Archive"
permalink: /secret/
---

<link rel="stylesheet" href="{{ '/assets/css/dl-style.css' | relative_url }}">

<style>
    .container, .page-content { max-width: 100% !important; padding: 0 20px !important; }
    .post-header { display: none; }

    /* í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .filter-btn {
        display: inline-block;
        font-size: 0.85rem;
        background: #f5f5f5;
        color: #555;
        padding: 6px 12px;
        border-radius: 20px;
        margin: 4px;
        border: 1px solid #ddd;
        cursor: pointer;
        transition: all 0.2s;
        user-select: none; /* ë“œë˜ê·¸ ë°©ì§€ */
    }
    .filter-btn:hover {
        background: #ffeef5;
        color: #E6007E;
        border-color: #E6007E;
    }
    /* ğŸš¨ ì„ íƒë˜ì—ˆì„ ë•Œ (í™œì„±í™”) */
    .filter-btn.active {
        background: #E6007E;  /* í•‘í¬ìƒ‰ ë°°ê²½ */
        color: #fff;           /* í°ìƒ‰ ê¸€ì”¨ */
        border-color: #E6007E;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(230, 0, 126, 0.3);
    }
</style>


<div id="lock-gate" style="text-align: center; padding: 100px 20px;">
    <h2 style="font-family: 'Noto Serif KR'; color: #780C1B; font-size: 2rem;">Restricted Area</h2>
    <p style="color: #666; margin-bottom: 30px;">
        ê´€ê³„ì ì™¸ ì¶œì… ê¸ˆì§€ êµ¬ì—­ì…ë‹ˆë‹¤.<br>
        ì„±ì¸ ì¸ì¦(ë¹„ë°€ë²ˆí˜¸)ì´ í•„ìš”í•©ë‹ˆë‹¤.
    </p>
    <input type="password" id="user-pass" placeholder="Password" 
           style="padding: 12px; border: 1px solid #ccc; width: 200px; text-align: center;">
    <button onclick="unlock()" 
            style="padding: 12px 25px; background: #780C1B; color: white; border: none; cursor: pointer; font-weight: bold;">
        Enter
    </button>
    <p id="error-msg" style="color: #780C1B; font-size: 0.8rem; margin-top: 15px; display: none;">
        â›” ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.
    </p>
</div>


<div id="secret-content" style="display: none; margin-top: 40px;">
    
    <div style="text-align:center; margin-bottom: 50px; border-bottom: 1px solid #eee; padding-bottom: 30px;">
        <h1 style="font-family: 'Noto Serif KR'; font-size: 2.5rem; color: #111; margin-bottom: 10px;">SECRET ARCHIVE</h1>
        <p style="color: #888; font-style: italic;">Douglas x Adeline : Unspoken Stories (R-18)</p>
    </div>

    <div class="dl-container">
        
        <aside class="dl-sidebar">
            
            <div class="dl-menu-box">
                <div class="dl-menu-title">ğŸ·ï¸ íƒœê·¸ í•„í„° (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)</div>
                <div id="tag-filter-container" style="padding: 15px;">
                    </div>
                <div style="text-align: center; padding-bottom: 15px;">
                    <button onclick="resetFilters()" style="font-size: 0.8rem; color: #888; background:none; border:none; cursor:pointer; text-decoration: underline;">
                        â†º í•„í„° ì´ˆê¸°í™”
                    </button>
                </div>
            </div>

            </aside>

        <main class="dl-main">
            <div class="dl-section-header">
                <h2 class="dl-section-title">ğŸ“¦ ì‘í’ˆ ëª©ë¡</h2>
                <span class="dl-section-more" id="item-count">Calculating...</span>
            </div>

            <div class="dl-grid" id="post-grid">
                
                {% for post in site.posts %}
                    {% if post.type == 'Secret' %}
                    
                    <a href="{{ post.url | relative_url }}" class="dl-card" 
                       data-tags="{{ post.tags | join: ',' }}">
                        
                        <div class="dl-thumb">
                            <span class="dl-badge">R-18</span>
                            {% if post.image %}
                                <img src="{{ post.image | relative_url }}" alt="{{ post.title }}">
                            {% else %}
                                <div style="width:100%; height:100%; background:#eee; display:flex; align-items:center; justify-content:center; color:#ccc;">No Image</div>
                            {% endif %}
                        </div>

                        <div class="dl-info">
                            <h3 class="dl-title">{{ post.title }}</h3>
                            <span class="dl-circle">Writer. {{ post.author | default: "ì¬ì€" }}</span>
                            <div class="dl-tags">
                                {% for tag in post.tags %}
                                    <span class="dl-tag">#{{ tag }}</span>
                                {% endfor %}
                            </div>
                            <div class="dl-footer">
                                <span class="dl-price">{{ post.date | date: "%Y.%m.%d" }}</span>
                                <span class="dl-btn">ì—´ëŒ</span>
                            </div>
                        </div>
                    </a>
                    
                    {% endif %}
                {% endfor %}

                <div id="no-result-msg" style="display:none; grid-column: 1 / -1; text-align: center; padding: 50px; color: #888;">
                    ì¡°ê±´ì— ë§ëŠ” ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤. ğŸ˜¢
                </div>

            </div>
        </main>
    </div>
</div>


<script>
    // === [1] ë¹„ë°€ë²ˆí˜¸ ì ê¸ˆ í•´ì œ ===
    function unlock() {
        var password = "201107"; 
        var input = document.getElementById("user-pass").value;
        var inputField = document.getElementById("user-pass");

        if (input === password) {
            document.getElementById("lock-gate").style.display = "none";
            document.getElementById("secret-content").style.display = "block";
            
            // ğŸ”“ ì ê¸ˆ í’€ë¦¬ë©´ í•„í„° ì‹œìŠ¤í…œ ê°€ë™!
            initTagSystem(); 
            
        } else {
            document.getElementById("error-msg").style.display = "block";
        }
    }
    
    // ì—”í„°í‚¤ ì§€ì›
    document.getElementById("user-pass").addEventListener("keypress", function(event) {
        if (event.key === "Enter") { event.preventDefault(); unlock(); }
    });


    // === [2] íƒœê·¸ í•„í„°ë§ ì‹œìŠ¤í…œ (ìë™í™”) ===
    
    // ì„ íƒëœ íƒœê·¸ë“¤ì„ ì €ì¥í•  ë°”êµ¬ë‹ˆ (Setì€ ì¤‘ë³µì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ë°°ì—´ì…ë‹ˆë‹¤)
    let selectedTags = new Set();

    function initTagSystem() {
        const cards = document.querySelectorAll('.dl-card');
        const tagContainer = document.getElementById('tag-filter-container');
        let allTags = new Set(); // ì „ì²´ íƒœê·¸ ìˆ˜ì§‘ìš©

        // 1. ëª¨ë“  ì¹´ë“œì—ì„œ íƒœê·¸ ìˆ˜ì§‘í•˜ê¸°
        cards.forEach(card => {
            const tags = card.dataset.tags.split(','); // "í˜„ëŒ€,ì˜¤í”¼ìŠ¤" -> ["í˜„ëŒ€", "ì˜¤í”¼ìŠ¤"]
            tags.forEach(tag => {
                if(tag.trim() !== "") allTags.add(tag.trim());
            });
        });

        // 2. ìˆ˜ì§‘ëœ íƒœê·¸ë¡œ ë²„íŠ¼ ë§Œë“¤ê¸°
        // (ê°€ë‚˜ë‹¤ìˆœ ì •ë ¬í•´ì„œ ì˜ˆì˜ê²Œ)
        const sortedTags = Array.from(allTags).sort();
        
        sortedTags.forEach(tag => {
            const btn = document.createElement('span');
            btn.className = 'filter-btn';
            btn.innerText = '#' + tag;
            
            // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            btn.onclick = () => toggleTag(tag, btn);
            
            tagContainer.appendChild(btn);
        });

        updateCount(); // ì´ˆê¸° ê°œìˆ˜ ì„¸ê¸°
    }


    // íƒœê·¸ë¥¼ ì¼œê³  ë„ëŠ” í•¨ìˆ˜
    function toggleTag(tag, btnElement) {
        // 1. ìƒíƒœ í† ê¸€ (ì¼œì ¸ìˆìœ¼ë©´ ë„ê³ , êº¼ì ¸ìˆìœ¼ë©´ í‚´)
        if (selectedTags.has(tag)) {
            selectedTags.delete(tag);       // ë°”êµ¬ë‹ˆì—ì„œ ë¹¼ê¸°
            btnElement.classList.remove('active'); // ë””ìì¸ ë„ê¸°
        } else {
            selectedTags.add(tag);          // ë°”êµ¬ë‹ˆì— ë‹´ê¸°
            btnElement.classList.add('active');    // ë””ìì¸ ì¼œê¸° (í•‘í¬ìƒ‰)
        }

        // 2. í•„í„°ë§ ì ìš©
        applyFilter();
    }


    // ì‹¤ì œ í•„í„°ë§ ë¡œì§ (êµì§‘í•© AND ì¡°ê±´)
    function applyFilter() {
        const cards = document.querySelectorAll('.dl-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const cardTags = card.dataset.tags.split(','); // ì´ ì¹´ë“œê°€ ê°€ì§„ íƒœê·¸ë“¤
            
            // ğŸš¨ í•µì‹¬ ë¡œì§: "ì„ íƒëœ ëª¨ë“  íƒœê·¸(selectedTags)ë¥¼ ì´ ì¹´ë“œê°€ ë‹¤ ê°€ì§€ê³  ìˆëŠ”ê°€?"
            // í•˜ë‚˜ë¼ë„ ë¹ ì ¸ìˆìœ¼ë©´ false
            const isMatch = Array.from(selectedTags).every(selected => cardTags.includes(selected));

            if (isMatch) {
                card.style.display = "flex"; // ë³´ì—¬ì£¼ê¸°
                visibleCount++;
            } else {
                card.style.display = "none"; // ìˆ¨ê¸°ê¸°
            }
        });

        // ê²°ê³¼ ì—†ìŒ ë©”ì‹œì§€ ì²˜ë¦¬
        const noResult = document.getElementById('no-result-msg');
        if (visibleCount === 0) noResult.style.display = "block";
        else noResult.style.display = "none";

        updateCount();
    }


    // í•„í„° ì´ˆê¸°í™” ë²„íŠ¼
    function resetFilters() {
        selectedTags.clear(); // ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
        
        // ëª¨ë“  ë²„íŠ¼ ë””ìì¸ ë„ê¸°
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        
        // ëª¨ë“  ì¹´ë“œ ë³´ì—¬ì£¼ê¸°
        applyFilter();
    }

    // ì•„ì´í…œ ê°œìˆ˜ ì—…ë°ì´íŠ¸
    function updateCount() {
        const visibleCards = document.querySelectorAll('.dl-card[style="display: flex;"]');
        const total = visibleCards.length > 0 ? visibleCards.length : document.querySelectorAll('.dl-card').length;
        // ì´ˆê¸° ë¡œë”©ì‹œì—” styleì†ì„±ì´ ì—†ìœ¼ë¯€ë¡œ ì „ì²´ ê°œìˆ˜ë¡œ ì¡í˜
        
        const countDisplay = document.getElementById('item-count');
        
        // style="display: none"ì´ ì•„ë‹Œ ê²ƒë§Œ ì„¸ê¸°
        let realCount = 0;
        document.querySelectorAll('.dl-card').forEach(c => {
            if(c.style.display !== 'none') realCount++;
        });
        
        countDisplay.innerText = "Total " + realCount + " Items";
    }
</script>
